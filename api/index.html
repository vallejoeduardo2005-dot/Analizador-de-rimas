<div id="analizador-container" style="background: rgb(249, 249, 249); border-radius: 8px; box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 8px; font-family: "Segoe UI", Tahoma, sans-serif; line-height: 1.6; margin: auto; max-width: 800px; padding: 20px;">
  <div style="color: #333333; margin-bottom: 12px; text-align: left;"><span style="font-weight: normal;">Analizador de rimas internas, consonantes y asonantes.<br /></span>Para multisilábica, encierra las sílabas entre paréntesis.</div>
  <textarea id="lyricsInput" placeholder="Pegue su letra aquí..." rows="8" style="background: rgb(255, 255, 255); border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #444444; font-family: Arial, sans-serif; font-size: 14px; padding: 12px; resize: vertical; width: 100%;">Nadie es dueño de nadie, me dijo alguien una vez
Nadie puede atar los pies, ni siquiera del que te acompaña
La mente es extraña, ayuda, pero a veces daña
La duda deambula, qué fácil es pensar que me engaña, que me falla
  </textarea>
  <div style="align-items: center; display: flex; gap: 8px; margin-top: 12px;">
    <button id="simpleBtn" style="background: rgb(76, 175, 80); border-radius: 4px; border: none; color: white; cursor: pointer; flex: 1 1 0%; font-size: 14px; padding: 10px;">Analizar (simple)</button>
    <button id="advancedBtn" style="background: rgb(33, 150, 243); border-radius: 4px; border: none; color: white; cursor: pointer; flex: 1 1 0%; font-size: 14px; padding: 10px;">Analizar (complejo)</button>
    <button id="clearBtn" style="background: rgb(244, 67, 54); border-radius: 4px; border: none; color: white; cursor: pointer; font-size: 14px; padding: 10px 16px;">Borrar</button>
  </div>
  <label style="color: #555555; display: block; font-size: 13px; margin-top: 8px;"><input checked="" id="fullWordCheckbox" style="margin-right: 6px;" type="checkbox" /> Colorear palabra entera (solo en simple)</label>
  <button id="copyBtn" style="background: rgb(255, 152, 0); border-radius: 4px; border: none; color: white; cursor: pointer; display: none; font-size: 14px; margin-top: 12px; padding: 8px 16px;">Copiar</button>


  <div id="colorizedOutput" style="color: black; font-family: Arial, sans-serif; margin-top: 20px;">
    <div id="colorizedBox" role="region" aria-label="Letra analizada" style="
      background: #ffffff;
      border: 1px solid #e6e6e6;
      border-radius: 8px;
      padding: 12px;
      max-height: 1040px;        /* <-- altura máxima del cuadro */
      overflow-y: auto;         /* <-- habilita la barra de desplazamiento vertical */
      box-shadow: inset 0 1px 0 rgba(0,0,0,0.02);
      line-height: 1.5;
      white-space: pre-wrap;
    "></div>
  </div>
</div>


<style>
/* Personalización ligera de scrollbars (WebKit + Firefox) */
#colorizedBox::-webkit-scrollbar { width: 10px; height: 10px; }
#colorizedBox::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.12); border-radius: 6px; }
#colorizedBox::-webkit-scrollbar-track { background: transparent; }
#colorizedBox { scrollbar-width: thin; scrollbar-color: rgba(0,0,0,0.12) transparent; }
</style>


<script>
(function(){
  const colorBox = document.getElementById('colorizedBox');
  const lyricsInput = document.getElementById('lyricsInput');
  const fullWordCheckbox = document.getElementById('fullWordCheckbox');
  const copyBtn = document.getElementById('copyBtn');
  
  function analyze(type) {
    const text = lyricsInput.value;
    const isFullWord = fullWordCheckbox.checked;


    fetch('/api/analyze', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ text, type, isFullWord })
    })
    .then(response => response.json())
    .then(data => {
      colorBox.innerHTML = data.html;
      copyBtn.style.display = data.html ? 'inline-block' : 'none';
    })
    .catch(error => {
      console.error('Error:', error);
      colorBox.innerHTML = '<p>Ocurrió un error al analizar la letra.</p>';
    });
  }


  document.getElementById('simpleBtn').onclick = () => analyze('simple');
  document.getElementById('advancedBtn').onclick = () => analyze('advanced');
  
  document.getElementById('clearBtn').onclick = () => {
    lyricsInput.value = '';
    colorBox.innerHTML = '';
    copyBtn.style.display = 'none';
  };
  
  copyBtn.onclick = () => {
    const temp = document.createElement('div');
    temp.innerHTML = colorBox.innerHTML;
    temp.style.background='white';
    temp.style.fontFamily='Arial, sans-serif';
    temp.style.position='absolute';
    temp.style.left='-9999px';
    document.body.appendChild(temp);
    const r = document.createRange();
    r.selectNodeContents(temp);
    const s = window.getSelection();
    s.removeAllRanges();
    s.addRange(r);
    document.execCommand('copy');
    s.removeAllRanges();
    document.body.removeChild(temp);
  };
})();
</script>